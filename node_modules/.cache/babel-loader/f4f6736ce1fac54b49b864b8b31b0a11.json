{"ast":null,"code":"'use strict';\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _get = function get(object, property, receiver) {\n  if (object === null) object = Function.prototype;\n  var desc = Object.getOwnPropertyDescriptor(object, property);\n\n  if (desc === undefined) {\n    var parent = Object.getPrototypeOf(object);\n\n    if (parent === null) {\n      return undefined;\n    } else {\n      return get(parent, property, receiver);\n    }\n  } else if (\"value\" in desc) {\n    return desc.value;\n  } else {\n    var getter = desc.get;\n\n    if (getter === undefined) {\n      return undefined;\n    }\n\n    return getter.call(receiver);\n  }\n};\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar LocalParticipantSignaling = require('../localparticipant');\n\nvar LocalTrackPublicationV2 = require('./localtrackpublication');\n\nvar _require = require('../../util'),\n    isDeepEqual = _require.isDeepEqual;\n/**\r\n * @extends ParticipantSignaling\r\n * @property {BandwidthProfileOptions} bandwidthProfile\r\n * @property {NetworkQualityConfigurationImpl} networkQualityConfiguration\r\n * @property {number} revision\r\n * @emits LocalParticipantV2#updated\r\n */\n\n\nvar LocalParticipantV2 = function (_LocalParticipantSign) {\n  _inherits(LocalParticipantV2, _LocalParticipantSign);\n  /**\r\n   * Construct a {@link LocalParticipantV2}.\r\n   * @param {EncodingParametersImpl} encodingParameters\r\n   * @param {NetworkQualityConfigurationImpl} networkQualityConfiguration\r\n   * @param {object} [options]\r\n   */\n\n\n  function LocalParticipantV2(encodingParameters, networkQualityConfiguration, options) {\n    _classCallCheck(this, LocalParticipantV2);\n\n    options = Object.assign({\n      LocalTrackPublicationV2: LocalTrackPublicationV2\n    }, options);\n\n    var _this = _possibleConstructorReturn(this, (LocalParticipantV2.__proto__ || Object.getPrototypeOf(LocalParticipantV2)).call(this));\n\n    Object.defineProperties(_this, {\n      _bandwidthProfile: {\n        value: null,\n        writable: true\n      },\n      _bandwidthProfileRevision: {\n        value: 0,\n        writable: true\n      },\n      _encodingParameters: {\n        value: encodingParameters\n      },\n      _removeListeners: {\n        value: new Map()\n      },\n      _LocalTrackPublicationV2: {\n        value: options.LocalTrackPublicationV2\n      },\n      _publishedRevision: {\n        writable: true,\n        value: 0\n      },\n      _revision: {\n        writable: true,\n        value: 1\n      },\n      _signalingRegion: {\n        value: null,\n        writable: true\n      },\n      bandwidthProfile: {\n        enumerable: true,\n        get: function get() {\n          return this._bandwidthProfile;\n        }\n      },\n      bandwidthProfileRevision: {\n        enumerable: true,\n        get: function get() {\n          return this._bandwidthProfileRevision;\n        }\n      },\n      networkQualityConfiguration: {\n        enumerable: true,\n        value: networkQualityConfiguration\n      },\n      revision: {\n        enumerable: true,\n        get: function get() {\n          return this._revision;\n        }\n      },\n      signalingRegion: {\n        enumerable: true,\n        get: function get() {\n          return this._signalingRegion;\n        }\n      }\n    });\n    return _this;\n  }\n  /**\r\n   * Set the signalingRegion.\r\n   * @param {string} signalingRegion.\r\n   */\n\n\n  _createClass(LocalParticipantV2, [{\n    key: 'setSignalingRegion',\n    value: function setSignalingRegion(signalingRegion) {\n      if (!this._signalingRegion) {\n        this._signalingRegion = signalingRegion;\n      }\n    }\n    /**\r\n     * Update the {@link BandwidthProfileOptions}.\r\n     * @param {BandwidthProfileOptions} bandwidthProfile\r\n     */\n\n  }, {\n    key: 'setBandwidthProfile',\n    value: function setBandwidthProfile(bandwidthProfile) {\n      if (!isDeepEqual(this._bandwidthProfile, bandwidthProfile)) {\n        // NOTE(mmalavalli): Object.assign() copies the values of only\n        // the top level properties. In order to deep copy the object, we\n        // stringify and parse the object.\n        this._bandwidthProfile = JSON.parse(JSON.stringify(bandwidthProfile));\n        this._bandwidthProfileRevision++;\n        this.didUpdate();\n      }\n    }\n    /**\r\n     * Set the {@link EncodingParameters}.\r\n     * @param {?EncodingParameters} encodingParameters\r\n     * @returns {this}\r\n     */\n\n  }, {\n    key: 'setParameters',\n    value: function setParameters(encodingParameters) {\n      this._encodingParameters.update(encodingParameters);\n\n      return this;\n    }\n    /**\r\n     * Update the {@link LocalParticipantV2} with the new state.\r\n     * @param {Published} published\r\n     * @returns {this}\r\n     */\n\n  }, {\n    key: 'update',\n    value: function update(published) {\n      if (this._publishedRevision >= published.revision) {\n        return this;\n      }\n\n      this._publishedRevision = published.revision;\n      published.tracks.forEach(function (publicationState) {\n        var localTrackPublicationV2 = this.tracks.get(publicationState.id);\n\n        if (localTrackPublicationV2) {\n          localTrackPublicationV2.update(publicationState);\n        }\n      }, this);\n      return this;\n    }\n    /**\r\n     * @protected\r\n     * @param {DataTrackSender|MediaTrackSender} trackSender\r\n     * @param {string} name\r\n     * @param {Track.Priority} priority\r\n     * @returns {LocalTrackPublicationV2}\r\n     */\n\n  }, {\n    key: '_createLocalTrackPublicationSignaling',\n    value: function _createLocalTrackPublicationSignaling(trackSender, name, priority) {\n      return new this._LocalTrackPublicationV2(trackSender, name, priority);\n    }\n    /**\r\n     * Add a {@link LocalTrackPublicationV2} for the given {@link DataTrackSender}\r\n     * or {@link MediaTrackSender} to the {@link LocalParticipantV2}.\r\n     * @param {DataTrackSender|MediaTrackSender} trackSender\r\n     * @param {string} name\r\n     * @param {Track.Priority} priority\r\n     * @returns {this}\r\n     */\n\n  }, {\n    key: 'addTrack',\n    value: function addTrack(trackSender, name, priority) {\n      var _this2 = this;\n\n      _get(LocalParticipantV2.prototype.__proto__ || Object.getPrototypeOf(LocalParticipantV2.prototype), 'addTrack', this).call(this, trackSender, name, priority);\n\n      var publication = this.getPublication(trackSender);\n      var isEnabled = publication.isEnabled,\n          updatedPriority = publication.updatedPriority;\n\n      var updated = function updated() {\n        // NOTE(mmalavalli): The LocalParticipantV2's state is only published if\n        // the \"updated\" event is emitted due to LocalTrackPublicationV2's\n        // .isEnabled or .updatedPriority being changed. We do not publish if it is fired due to the\n        // LocalTrackPublicationV2's .sid being set.\n        if (isEnabled !== publication.isEnabled || updatedPriority !== publication.updatedPriority) {\n          _this2.didUpdate();\n\n          isEnabled = publication.isEnabled;\n          updatedPriority = publication.updatedPriority;\n        }\n      };\n\n      publication.on('updated', updated);\n\n      this._removeListener(publication);\n\n      this._removeListeners.set(publication, function () {\n        return publication.removeListener('updated', updated);\n      });\n\n      this.didUpdate();\n      return this;\n    }\n    /**\r\n     * @private\r\n     * @param {LocalTrackPublicationV2} publication\r\n     * @returns {void}\r\n     */\n\n  }, {\n    key: '_removeListener',\n    value: function _removeListener(publication) {\n      var removeListener = this._removeListeners.get(publication);\n\n      if (removeListener) {\n        removeListener();\n      }\n    }\n    /**\r\n     * Get the current state of the {@link LocalParticipantV2}.\r\n     * @returns {object}\r\n     */\n\n  }, {\n    key: 'getState',\n    value: function getState() {\n      return {\n        revision: this.revision,\n        tracks: Array.from(this.tracks.values()).map(function (track) {\n          return track.getState();\n        })\n      };\n    }\n    /**\r\n     * Increment the revision for the {@link LocalParticipantV2}.\r\n     * @private\r\n     * @returns {void}\r\n     */\n\n  }, {\n    key: 'didUpdate',\n    value: function didUpdate() {\n      this._revision++;\n      this.emit('updated');\n    }\n    /**\r\n     * Remove the {@link LocalTrackPublicationV2} for the given {@link DataTrackSender}\r\n     * or {@link MediaTrackSender} from the {@link LocalParticipantV2}.\r\n     * @param {DataTrackSender|MediaTrackSender} trackSender\r\n     * @returns {?LocalTrackPublicationV2}\r\n     */\n\n  }, {\n    key: 'removeTrack',\n    value: function removeTrack(trackSender) {\n      var publication = _get(LocalParticipantV2.prototype.__proto__ || Object.getPrototypeOf(LocalParticipantV2.prototype), 'removeTrack', this).call(this, trackSender);\n\n      if (publication) {\n        trackSender.removeClone(publication.trackTransceiver);\n\n        this._removeListener(publication);\n\n        this.didUpdate();\n      }\n\n      return publication;\n    }\n    /**\r\n     * Updates the verbosity of network quality information.\r\n     * @param {NetworkQualityConfiguration} networkQualityConfiguration\r\n     * @returns {void}\r\n     */\n\n  }, {\n    key: 'setNetworkQualityConfiguration',\n    value: function setNetworkQualityConfiguration(networkQualityConfiguration) {\n      this.networkQualityConfiguration.update(networkQualityConfiguration);\n    }\n  }]);\n\n  return LocalParticipantV2;\n}(LocalParticipantSignaling);\n/**\r\n * @interface Published\r\n * @property {number} revision\r\n * @property {Array<PublishedTrack>} tracks\r\n */\n\n/**\r\n * @typedef {CreatedTrack|ReadyTrack|FailedTrack} PublishedTrack\r\n */\n\n/**\r\n * @interface CreatedTrack\r\n * @property {Track.ID} id\r\n * @property {string} state - \"created\"\r\n */\n\n/**\r\n * @interface ReadyTrack\r\n * @property {Track.ID} id\r\n * @property {Track.SID} sid\r\n * @property {string} state - \"ready\"\r\n */\n\n/**\r\n * @interface FailedTrack\r\n * @property {Track.ID} id\r\n * @property {TrackError} error\r\n * @property {string} state - \"failed\"\r\n */\n\n/**\r\n * @interface TrackError\r\n * @property {number} code\r\n * @property {string} message\r\n */\n\n/**\r\n * @event LocalParticipantV2#updated\r\n */\n\n\nmodule.exports = LocalParticipantV2;","map":{"version":3,"sources":["C:/Users/USER/Desktop/ARSW III/Twilio/node_modules/twilio-video/es5/signaling/v2/localparticipant.js"],"names":["_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","Constructor","protoProps","staticProps","prototype","_get","get","object","property","receiver","Function","desc","getOwnPropertyDescriptor","undefined","parent","getPrototypeOf","value","getter","call","_classCallCheck","instance","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","LocalParticipantSignaling","require","LocalTrackPublicationV2","_require","isDeepEqual","LocalParticipantV2","_LocalParticipantSign","encodingParameters","networkQualityConfiguration","options","assign","_this","_bandwidthProfile","_bandwidthProfileRevision","_encodingParameters","_removeListeners","Map","_LocalTrackPublicationV2","_publishedRevision","_revision","_signalingRegion","bandwidthProfile","bandwidthProfileRevision","revision","signalingRegion","setSignalingRegion","setBandwidthProfile","JSON","parse","stringify","didUpdate","setParameters","update","published","tracks","forEach","publicationState","localTrackPublicationV2","id","_createLocalTrackPublicationSignaling","trackSender","name","priority","addTrack","_this2","publication","getPublication","isEnabled","updatedPriority","updated","on","_removeListener","set","removeListener","getState","Array","from","values","map","track","emit","removeTrack","removeClone","trackTransceiver","setNetworkQualityConfiguration","module","exports"],"mappings":"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","sourcesContent":["'use strict';\r\n\r\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\r\n\r\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\r\n\r\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\r\n\r\nvar LocalParticipantSignaling = require('../localparticipant');\r\nvar LocalTrackPublicationV2 = require('./localtrackpublication');\r\n\r\nvar _require = require('../../util'),\r\n    isDeepEqual = _require.isDeepEqual;\r\n\r\n/**\r\n * @extends ParticipantSignaling\r\n * @property {BandwidthProfileOptions} bandwidthProfile\r\n * @property {NetworkQualityConfigurationImpl} networkQualityConfiguration\r\n * @property {number} revision\r\n * @emits LocalParticipantV2#updated\r\n */\r\n\r\n\r\nvar LocalParticipantV2 = function (_LocalParticipantSign) {\r\n  _inherits(LocalParticipantV2, _LocalParticipantSign);\r\n\r\n  /**\r\n   * Construct a {@link LocalParticipantV2}.\r\n   * @param {EncodingParametersImpl} encodingParameters\r\n   * @param {NetworkQualityConfigurationImpl} networkQualityConfiguration\r\n   * @param {object} [options]\r\n   */\r\n  function LocalParticipantV2(encodingParameters, networkQualityConfiguration, options) {\r\n    _classCallCheck(this, LocalParticipantV2);\r\n\r\n    options = Object.assign({\r\n      LocalTrackPublicationV2: LocalTrackPublicationV2\r\n    }, options);\r\n\r\n    var _this = _possibleConstructorReturn(this, (LocalParticipantV2.__proto__ || Object.getPrototypeOf(LocalParticipantV2)).call(this));\r\n\r\n    Object.defineProperties(_this, {\r\n      _bandwidthProfile: {\r\n        value: null,\r\n        writable: true\r\n      },\r\n      _bandwidthProfileRevision: {\r\n        value: 0,\r\n        writable: true\r\n      },\r\n      _encodingParameters: {\r\n        value: encodingParameters\r\n      },\r\n      _removeListeners: {\r\n        value: new Map()\r\n      },\r\n      _LocalTrackPublicationV2: {\r\n        value: options.LocalTrackPublicationV2\r\n      },\r\n      _publishedRevision: {\r\n        writable: true,\r\n        value: 0\r\n      },\r\n      _revision: {\r\n        writable: true,\r\n        value: 1\r\n      },\r\n      _signalingRegion: {\r\n        value: null,\r\n        writable: true\r\n      },\r\n      bandwidthProfile: {\r\n        enumerable: true,\r\n        get: function get() {\r\n          return this._bandwidthProfile;\r\n        }\r\n      },\r\n      bandwidthProfileRevision: {\r\n        enumerable: true,\r\n        get: function get() {\r\n          return this._bandwidthProfileRevision;\r\n        }\r\n      },\r\n      networkQualityConfiguration: {\r\n        enumerable: true,\r\n        value: networkQualityConfiguration\r\n      },\r\n      revision: {\r\n        enumerable: true,\r\n        get: function get() {\r\n          return this._revision;\r\n        }\r\n      },\r\n      signalingRegion: {\r\n        enumerable: true,\r\n        get: function get() {\r\n          return this._signalingRegion;\r\n        }\r\n      }\r\n    });\r\n    return _this;\r\n  }\r\n\r\n  /**\r\n   * Set the signalingRegion.\r\n   * @param {string} signalingRegion.\r\n   */\r\n\r\n\r\n  _createClass(LocalParticipantV2, [{\r\n    key: 'setSignalingRegion',\r\n    value: function setSignalingRegion(signalingRegion) {\r\n      if (!this._signalingRegion) {\r\n        this._signalingRegion = signalingRegion;\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Update the {@link BandwidthProfileOptions}.\r\n     * @param {BandwidthProfileOptions} bandwidthProfile\r\n     */\r\n\r\n  }, {\r\n    key: 'setBandwidthProfile',\r\n    value: function setBandwidthProfile(bandwidthProfile) {\r\n      if (!isDeepEqual(this._bandwidthProfile, bandwidthProfile)) {\r\n        // NOTE(mmalavalli): Object.assign() copies the values of only\r\n        // the top level properties. In order to deep copy the object, we\r\n        // stringify and parse the object.\r\n        this._bandwidthProfile = JSON.parse(JSON.stringify(bandwidthProfile));\r\n        this._bandwidthProfileRevision++;\r\n        this.didUpdate();\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Set the {@link EncodingParameters}.\r\n     * @param {?EncodingParameters} encodingParameters\r\n     * @returns {this}\r\n     */\r\n\r\n  }, {\r\n    key: 'setParameters',\r\n    value: function setParameters(encodingParameters) {\r\n      this._encodingParameters.update(encodingParameters);\r\n      return this;\r\n    }\r\n\r\n    /**\r\n     * Update the {@link LocalParticipantV2} with the new state.\r\n     * @param {Published} published\r\n     * @returns {this}\r\n     */\r\n\r\n  }, {\r\n    key: 'update',\r\n    value: function update(published) {\r\n      if (this._publishedRevision >= published.revision) {\r\n        return this;\r\n      }\r\n\r\n      this._publishedRevision = published.revision;\r\n\r\n      published.tracks.forEach(function (publicationState) {\r\n        var localTrackPublicationV2 = this.tracks.get(publicationState.id);\r\n        if (localTrackPublicationV2) {\r\n          localTrackPublicationV2.update(publicationState);\r\n        }\r\n      }, this);\r\n\r\n      return this;\r\n    }\r\n\r\n    /**\r\n     * @protected\r\n     * @param {DataTrackSender|MediaTrackSender} trackSender\r\n     * @param {string} name\r\n     * @param {Track.Priority} priority\r\n     * @returns {LocalTrackPublicationV2}\r\n     */\r\n\r\n  }, {\r\n    key: '_createLocalTrackPublicationSignaling',\r\n    value: function _createLocalTrackPublicationSignaling(trackSender, name, priority) {\r\n      return new this._LocalTrackPublicationV2(trackSender, name, priority);\r\n    }\r\n\r\n    /**\r\n     * Add a {@link LocalTrackPublicationV2} for the given {@link DataTrackSender}\r\n     * or {@link MediaTrackSender} to the {@link LocalParticipantV2}.\r\n     * @param {DataTrackSender|MediaTrackSender} trackSender\r\n     * @param {string} name\r\n     * @param {Track.Priority} priority\r\n     * @returns {this}\r\n     */\r\n\r\n  }, {\r\n    key: 'addTrack',\r\n    value: function addTrack(trackSender, name, priority) {\r\n      var _this2 = this;\r\n\r\n      _get(LocalParticipantV2.prototype.__proto__ || Object.getPrototypeOf(LocalParticipantV2.prototype), 'addTrack', this).call(this, trackSender, name, priority);\r\n      var publication = this.getPublication(trackSender);\r\n\r\n      var isEnabled = publication.isEnabled,\r\n          updatedPriority = publication.updatedPriority;\r\n\r\n\r\n      var updated = function updated() {\r\n        // NOTE(mmalavalli): The LocalParticipantV2's state is only published if\r\n        // the \"updated\" event is emitted due to LocalTrackPublicationV2's\r\n        // .isEnabled or .updatedPriority being changed. We do not publish if it is fired due to the\r\n        // LocalTrackPublicationV2's .sid being set.\r\n        if (isEnabled !== publication.isEnabled || updatedPriority !== publication.updatedPriority) {\r\n          _this2.didUpdate();\r\n          isEnabled = publication.isEnabled;\r\n          updatedPriority = publication.updatedPriority;\r\n        }\r\n      };\r\n\r\n      publication.on('updated', updated);\r\n\r\n      this._removeListener(publication);\r\n      this._removeListeners.set(publication, function () {\r\n        return publication.removeListener('updated', updated);\r\n      });\r\n\r\n      this.didUpdate();\r\n\r\n      return this;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * @param {LocalTrackPublicationV2} publication\r\n     * @returns {void}\r\n     */\r\n\r\n  }, {\r\n    key: '_removeListener',\r\n    value: function _removeListener(publication) {\r\n      var removeListener = this._removeListeners.get(publication);\r\n      if (removeListener) {\r\n        removeListener();\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Get the current state of the {@link LocalParticipantV2}.\r\n     * @returns {object}\r\n     */\r\n\r\n  }, {\r\n    key: 'getState',\r\n    value: function getState() {\r\n      return {\r\n        revision: this.revision,\r\n        tracks: Array.from(this.tracks.values()).map(function (track) {\r\n          return track.getState();\r\n        })\r\n      };\r\n    }\r\n\r\n    /**\r\n     * Increment the revision for the {@link LocalParticipantV2}.\r\n     * @private\r\n     * @returns {void}\r\n     */\r\n\r\n  }, {\r\n    key: 'didUpdate',\r\n    value: function didUpdate() {\r\n      this._revision++;\r\n      this.emit('updated');\r\n    }\r\n\r\n    /**\r\n     * Remove the {@link LocalTrackPublicationV2} for the given {@link DataTrackSender}\r\n     * or {@link MediaTrackSender} from the {@link LocalParticipantV2}.\r\n     * @param {DataTrackSender|MediaTrackSender} trackSender\r\n     * @returns {?LocalTrackPublicationV2}\r\n     */\r\n\r\n  }, {\r\n    key: 'removeTrack',\r\n    value: function removeTrack(trackSender) {\r\n      var publication = _get(LocalParticipantV2.prototype.__proto__ || Object.getPrototypeOf(LocalParticipantV2.prototype), 'removeTrack', this).call(this, trackSender);\r\n      if (publication) {\r\n        trackSender.removeClone(publication.trackTransceiver);\r\n        this._removeListener(publication);\r\n        this.didUpdate();\r\n      }\r\n      return publication;\r\n    }\r\n\r\n    /**\r\n     * Updates the verbosity of network quality information.\r\n     * @param {NetworkQualityConfiguration} networkQualityConfiguration\r\n     * @returns {void}\r\n     */\r\n\r\n  }, {\r\n    key: 'setNetworkQualityConfiguration',\r\n    value: function setNetworkQualityConfiguration(networkQualityConfiguration) {\r\n      this.networkQualityConfiguration.update(networkQualityConfiguration);\r\n    }\r\n  }]);\r\n\r\n  return LocalParticipantV2;\r\n}(LocalParticipantSignaling);\r\n\r\n/**\r\n * @interface Published\r\n * @property {number} revision\r\n * @property {Array<PublishedTrack>} tracks\r\n */\r\n\r\n/**\r\n * @typedef {CreatedTrack|ReadyTrack|FailedTrack} PublishedTrack\r\n */\r\n\r\n/**\r\n * @interface CreatedTrack\r\n * @property {Track.ID} id\r\n * @property {string} state - \"created\"\r\n */\r\n\r\n/**\r\n * @interface ReadyTrack\r\n * @property {Track.ID} id\r\n * @property {Track.SID} sid\r\n * @property {string} state - \"ready\"\r\n */\r\n\r\n/**\r\n * @interface FailedTrack\r\n * @property {Track.ID} id\r\n * @property {TrackError} error\r\n * @property {string} state - \"failed\"\r\n */\r\n\r\n/**\r\n * @interface TrackError\r\n * @property {number} code\r\n * @property {string} message\r\n */\r\n\r\n/**\r\n * @event LocalParticipantV2#updated\r\n */\r\n\r\nmodule.exports = LocalParticipantV2;"]},"metadata":{},"sourceType":"script"}